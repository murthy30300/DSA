package com.tcs.roundii;
import java.util.*;
import java.io.*;
import java.io.*;
import java.util.*;

public class Cubemid {

    static class Cell {
        int l, r, c;
        Cell(int l, int r, int c) { this.l = l; this.r = r; this.c = c; }
    }

    public static void main(String[] args) throws Exception {

        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        int S = Integer.parseInt(br.readLine().trim());

        char[][][] cube = new char[S][S][S];

        for (int l = 0; l < S; l++) {
            for (int r = 0; r < S; r++) {
                String line = br.readLine().trim();
                for (int c = 0; c < S; c++) {
                    cube[l][r][c] = line.charAt(c);
                }
            }
        }

        String[] s1 = br.readLine().trim().split(" ");
        int sl = Integer.parseInt(s1[0]);
        int sr = Integer.parseInt(s1[1]);
        int sc = Integer.parseInt(s1[2]);

        String[] s2 = br.readLine().trim().split(" ");
        int gl = Integer.parseInt(s2[0]);
        int gr = Integer.parseInt(s2[1]);
        int gc = Integer.parseInt(s2[2]);

        boolean[][][] visited = new boolean[S][S][S];
        int[][][] dist = new int[S][S][S];

        for (int l = 0; l < S; l++)
            for (int r = 0; r < S; r++)
                Arrays.fill(dist[l][r], -1);

        Queue<Cell> q = new LinkedList<>();
        q.offer(new Cell(sl, sr, sc));
        visited[sl][sr][sc] = true;
        dist[sl][sr][sc] = 0;

        int[][] dir = {{-1,0}, {1,0}, {0,-1}, {0,1}}; // up, down, left, right

        while (!q.isEmpty()) {

            Cell cur = q.poll();
            int l = cur.l, r = cur.r, c = cur.c;

            if (l == gl && r == gr && c == gc) {
                System.out.println(dist[l][r][c]);
                return;
            }

            char type = cube[l][r][c];

            // BLOCKED type
            if (type == 'E') continue;

            // 1. Normal horizontal moves (allowed for D, R, L, F, B)
            for (int[] d : dir) {
                int nr = r + d[0];
                int nc = c + d[1];

                if (nr >= 0 && nr < S && nc >= 0 && nc < S) {
                    if (!visited[l][nr][nc] && cube[l][nr][nc] != 'E') {
                        visited[l][nr][nc] = true;
                        dist[l][nr][nc] = dist[l][r][c] + 1;
                        q.offer(new Cell(l, nr, nc));
                    }
                }
            }

            // 2. Extra moves based on chamber type
            if (type == 'R') {
                int nl = l + 1, nc = c + 1;
                if (nl < S && nc < S) {
                    if (!visited[nl][r][nc] && cube[nl][r][nc] != 'E') {
                        visited[nl][r][nc] = true;
                        dist[nl][r][nc] = dist[l][r][c] + 1;
                        q.offer(new Cell(nl, r, nc));
                    }
                }
            }

            if (type == 'L') {
                int nl = l + 1, nc = c - 1;
                if (nl < S && nc >= 0) {
                    if (!visited[nl][r][nc] && cube[nl][r][nc] != 'E') {
                        visited[nl][r][nc] = true;
                        dist[nl][r][nc] = dist[l][r][c] + 1;
                        q.offer(new Cell(nl, r, nc));
                    }
                }
            }

            if (type == 'F') { // go down a layer
                int nl = l + 1;
                if (nl < S) {
                    if (!visited[nl][r][c] && cube[nl][r][c] != 'E') {
                        visited[nl][r][c] = true;
                        dist[nl][r][c] = dist[l][r][c] + 1;
                        q.offer(new Cell(nl, r, c));
                    }
                }
            }

            if (type == 'B') { // go up a layer
                int nl = l - 1;
                if (nl >= 0) {
                    if (!visited[nl][r][c] && cube[nl][r][c] != 'E') {
                        visited[nl][r][c] = true;
                        dist[nl][r][c] = dist[l][r][c] + 1;
                        q.offer(new Cell(nl, r, c));
                    }
                }
            }
        }

        // unreachable
        System.out.println(-1);
    }
}
